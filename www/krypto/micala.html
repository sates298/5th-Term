<!DOCTYPE html>
<html lang="pl" dir="ltr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Micala</title>
    <link rel="stylesheet" href="style.css"/>
    <script src="latex.js"></script>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


    <link rel="stylesheet" href="pseudocode.js-1.1/pseudocode.min.css" type="text/css">
    <script src="pseudocode.js-1.1/pseudocode.min.js" type="text/javascript"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta/katex.min.css" integrity="sha384-L/SNYu0HM7XECWBeshTGLluQO9uVI1tvkCtunuoUbCHHoTH76cDyXty69Bb9I0qZ" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta/katex.min.js" integrity="sha384-ad+n9lzhJjYgO67lARKETJH6WuQVDDlRfj81AJJSswMyMkXTD49wBj5EP004WOY6" crossorigin="anonymous"></script>
</head>
<body onload="renderPseudocodes()">               
    <div id="header" >
        <header>
                Schemat Goldwasser-Micali szyfrowania probabilistycznego
        </header>
    </div>
    <div id="menu">
        <nav>
            <a class="redirect" href="index.html">Strona startowa</a>
            <a class="redrect" href="micala.html">Schemat Goldwasser-Micali szyfrowania probabilistycznego</a>
            <a class="redrect" href="shamir.html">Schemat progowy $(t, n)$ dzielenia sekretu Shamira</a>
        </nav>
    </div>
    <div id="section-nav">
        <nav>
            <a class="link" href="#square">Reszta/niereszta kwadratowa</a>
            <a class="link" href="#legendre">Symbol Legendre’a</a>
            <a class="link" href="#jacobi">Symbol Jacobiego</a>
            <a class="link" href="#micala">Schemat Goldwasser-Micali szyfrowania probabilistycznego</a>
        </nav>
    </div>

    <div id="content">
        <section id="square">
            <h2 class="section-header">1. Reszta/niereszta kwadratowa</h2>
            <div class="items">
                <h3 class="item-header">Definicja</h3>
                <p class="description">
                    Niech $a \in \mathbb{Z}_{n}$.  Mówimy, że $a$ jest resztą kwadratową modulo $n$ (kwadratem modulo $n$), jeżeli istnieje $x \in \mathbb{Z}_{n}^{*}$ takie, że $x_{2} \equiv a$ (mod $p$). Jeżeli takie $x$ nie istnieje, to wówczasa nazywamy $nieresztą$ $kwadratową$ $modulo$ $n$. Zbiór wszystkich reszt kwadratowych modulo $n$ oznaczamy $Q_{n}$, zaś zbiór wszystkich niereszt kwadratowych modulo $n$ oznaczamy $\overline{Q}_{n}$.
                </p>
            </div>
        </section>
        <section id="legendre">
            <h2 class="section-header">2. Symbol Legendre’a</h2>
            <div class="items">
                <h3 class="item-header">Definicja</h3>
                <p class="description">
                    Niech $p$ będzie nieparzystą liczbą pierwszą a $a$ liczbą całkowitą. Symbol Legendre'a $(\frac{a}{p})$ jest zdefiniowany jako:
                    $$(\frac{a}{p}) = TODO$$
                </p>
                <h3 class="item-header">Własność</h3>
                <p class="description">
                    Niech $a,b \in \mathbb{Z}$, zaś $p$ to nieparzysta liczba pierwsza. Wówczas:
                    <ul>
                        <li>$(\frac{a}{p}) \equiv a^{\frac{(p-1)}{2}}$ (mod $p$)</li>
                        <li>$(\frac{ab}{p}) = (\frac{a}{p})(\frac{b}{p})$</li>
                        <li>$a \equiv b$ (mod $p$) $\implies (\frac{a}{p}) = (\frac{b}{p})$</li>
                        <li>$(\frac{2}{p}) = (-1)^{\frac{(p^2 - 1)}{8}}$</li>
                        <li>
                            Jeżeli $q$ jest nieparzystą liczbą pierwszą inną od $p$ to:
                             $$(\frac{p}{q}) = (\frac{q}{p})(-1)^{(\frac{(p-1)(q-1)}{4})}$$
                        </li>
                    </ul>
                </p>
            </div>
        </section>
        <section id="jacobi">
            <h2 class="section-header">3. Symbol Jacobiego</h2>
            <div class="items">
                <h3 class="item-header">Definicja</h3>
                <p class="description">
                    Niech $n \geq 3$ jest liczbą nieparzystą a jej rozkład na czynniki pierwsze to $n=p_1^{e_1}p_2^{e_2}...p_k^{e_k}$. Symbol Jacobiego $(\frac{a}{n})$ jest zdefiniowany jako:
                    $$(\frac{a}{n}) = (\frac{a}{p_1})^{e_1}(\frac{a}{p_2})^{e_2}...(\frac{a}{p_k})^{e_k} $$
                    Jeżeli $n$ jest liczbą pierwszą, to symbol Jacobiego jest symbolem Legendre'a.
                </p>
                <h3 class="item-header">Własność</h3>
                <p class="description">
                    Niech $a,b \in \mathbb{Z}$, zaś $m,n \geq 3$ to nieparzyste liczby całkowite. Wówczas:
                    <ul>
                        <li>$(\frac{a}{n})=0,1,$albo $-1$. Ponadto $(\frac{a}{n}) = 0 \iff gcd(a,n) \ne 1$</li>
                        <li>$(\frac{ab}{n}) = (\frac{a}{n})(\frac{b}{n})$</li>
                        <li>$(\frac{a}{mn})=(\frac{a}{m})(\frac{a}{n})$</li>
                        <li>$a \equiv b$ (mod $n$)$\implies (\frac{a}{n}) = (\frac{b}{n})$</li>
                        <li>$(\frac{1}{n}) = 1$</li>
                        <li>$(\frac{-1}{n}) = (-1)^{\frac{(n-1)}{2}}$</li>
                        <li>$(\frac{2}{n}) = (-1)^{\frac{(n^2-1)}{8}}$</li>
                        <li>$(\frac{m}{n}) = (\frac{n}{m})(-1)^{\frac{(m-1)(n-1)}{4}}$</li>
                    </ul>
                    Z własności symbolu Jacobiego wynika, ze jeśli $n$ jest nieparzyste oraz $a$ nieparzyste i w postaci $a=2^ea_1$, gdzie $a_1$ też nieparzyste to:
                    $$(\frac{a}{n})= (\frac{2^e}{n})(\frac{a_1}{n})= (\frac{2}{n})^e(\frac{n \ mod \ a_1}{a_1})(-1)^{\frac{(a_1-1)(n-1)}{4}}$$
                </p>
                <h3 class="item-header">Obliczanie symbolu Jacobiego (i Legendre'a)</h3>
                <p class="description" id="jacobi-legendre">
                    Obliczanie symoli dla nieparzystej liczby całkowitej $n \geq 3$ oraz całkowitego $0 \leq a \leq n$.
                    <div class="pseudocode-parent" >
                        <pre class="pseudocode" style="display: none;">
                            \begin{algorithm}
                            \caption{JACOBI $(a, n)$}
                            \begin{algorithmic}
                            \IF{$a=0$} 
                                \RETURN $0$ 
                            \ENDIF
                            \IF{$a=1$} 
                                \RETURN $1$ 
                            \ENDIF
                            \STATE Write $a=2^ea_1$, gdzie $a_1$ jest nieparzyste
                            \IF{$e$ parzyste} 
                                \STATE $s \gets 1$ 
                            \ELSE
                                \IF{$n \equiv 1 \lor 7 \ (mod \ 8)$}
                                    \STATE $s \gets 1$
                                \ELSEIF{$n \equiv 3 \lor 5 \ (mod \ 8)$}
                                    \STATE $s \gets -1$
                                \ENDIF
                            \ENDIF
                            \IF{$n \equiv 3 \ (mod \ 4) \land a_1 \equiv 3 \ (mod \ 4)$}
                                \STATE $s \gets -s$
                            \ENDIF
                            \STATE $n_1 \gets n \ mod \ a_1$
                            \IF{$a_1 = 1$}
                                \RETURN s
                            \ELSE
                                \RETURN $s*$\CALL{JACOBI}{$n_1, a_1$}
                            \ENDIF
                            \end{algorithmic}
                            \end{algorithm}
                        </pre>
                    </div>
                    Algorytm działa w czasie $O((\log{n})^2)$ operacji bitowych.
                </p>
            </div>
        </section>
        <section id="micala">
            <h2 class="section-header">4. Schemat Goldwasser-Micali szyfrowania probabilistycznego</h2>
            <div class="items">
                <h3 class="item-header">Algorytm generowania kluczy</h3>
                <p class="description algorithm">
                    <ul>
                        <li>Wybierz losowo dwie duże liczby pierwsze $p$ oraz $q$ (podobnego rozmiaru)</li>
                        <li>Policz $n=pq$</li>
                        <li>Wybierz $y \in \mathbb{Z}_{n}$, takie, że $y$ jest nieresztą kwadratową modulo $n$ i symbol Jacobiego $(\frac{y}{n}) = 1$ (czyli $y$ jest pseudokwadratem modulo $n$)</li>
                        <li>Klucz publiczny stanowi para $(n, y)$, zaś odpowiadający mu klucz prywatny to para $(p, q)$</li>
                    </ul>
                </p>
                <h3 class="item-header">Algorytm szyfrowania</h3>
                <p class="description algorithm">
                    Chcąc zaszyfrować wiadomość $m$ przy użycia klucza publicznego $(n,y)$ wykonaj kroki:
                    <ul>
                        <li>Przedstaw $m$ w postaci łańcucha binarnego $m = m_1m_2...m_t$ dłuości $t$</li>
                        <li>
                            <div class="pseudocode-parent" >
                                <pre class="pseudocode" style="display: none;">
                                    \begin{algorithmic}
                                    \FOR{$i=1$ \TO $t$}
                                        \STATE wybierz losowe $x \in \mathbb{Z}_n^*$
                                        \IF{$m_i = 1$}
                                            \STATE $c_i \gets yx^2 \ mod \ n$
                                        \ELSE
                                            \STATE $c_i \gets x^2 \ mod \ n$
                                        \ENDIF
                                    \ENDFOR
                                    \end{algorithmic}
                                </pre>
                            </div>
                        </li>
                        <li>Kryptogram wiadomości $m$ stanowi $c=(c_1,c_2,...,c_t)$</li>
                    </ul>

                </p>
                <h3 class="item-header">Algorytm deszyfrowania</h3>
                <p class="description algorithm">
                    Chcąc odzyskać wiadomość z kryptogramu $c$ przy użycia klucza prywatnego $(p,q)$ wykonaj kroki:
                    <ul>
                        <li>
                            <div class="pseudocode-parent">
                                <pre class="pseudocode" style="display: none;">
                                    \begin{algorithmic}
                                    \FOR{$i=1$ \TO $t$}
                                        \STATE policz symbol Legendre'a $e_i = (\frac{c_i}{p})$
                                        \IF{$e_i = 1$}
                                            \STATE $m_i \gets 0$
                                        \ELSE
                                            \STATE $m_i \gets 1$
                                        \ENDIF 
                                    \ENDFOR
                                    \end{algorithmic}
                                </pre>
                            </div>
                        </li>
                        <li>Zdeszyfrowana wiadomość to $m = m_1m_2...m_t$</li>
                    </ul>
                </p>
            </div>
        </section>
    </div>
</body>
</html>